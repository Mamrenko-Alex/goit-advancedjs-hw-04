{"version":3,"file":"commonHelpers.js","sources":["../src/js/settings.js","../src/js/paxabay-api.js","../src/main.js"],"sourcesContent":["import Notiflix from 'https://cdn.jsdelivr.net/npm/notiflix@3/+esm';\nexport {message, KEY, PERPAGE}\n \nconst message = {\n    success(message) {\n        Notiflix.Notify.success(message);\n    },\n    error(message) {\n        Notiflix.Notify.failure(message);\n    },\n    info(message) {\n      Notiflix.Notify.info(message)\n  }\n}\n\nconst KEY = '40858568-c2cbea82fefa532e5a07e25a9'\n\nlet PERPAGE = 40;","import axios from \"axios\";\nimport { message, KEY } from \"./settings\";\nexport { getImages };\n    \n\nasync function getImages({querry, safesearch, page, perPage}) {\n    try {\n        const response = await axios.get(`https://pixabay.com/api/?key=${KEY}&q=${querry}&image_type=photo&orientation=horizontal&safesearch=${safesearch}&page=${page}&per_page=${perPage}`)\n        return response.data\n    } catch (error) {\n        message.error('No response from the server, try again later');\n    }\n}\n","import { getImages } from \"./js/paxabay-api\";\nimport { message, PERPAGE } from \"./js/settings\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport _ from 'lodash';\n\nlet gallery;\nlet page = 1;\nlet currentQuerry = '';\nlet isLoading = false;\n\n\nconst searchForm = document.querySelector('.search-form');\n\nconst elements = {\n    body: document.body,\n    searchField: searchForm.elements.searchQuery,\n    safeSearchField: searchForm.elements.safesearch, \n    galerry: document.querySelector('.gallery')\n}\n\nfunction createGalerry(galerryItems) {\n    const markup = galerryItems.map(({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n    }) => {\n        return `\n        <div class=\"photo-card\">\n            <a href=\"${largeImageURL}\" class=\"gallery__link\">\n                <img class=\"photo-img\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n            </a>\n            <div class=\"info\">\n                <p class=\"info-item\">\n                    <b>Likes</b><span class=\"js-data\">${likes}</span>\n                </p>\n                <p class=\"info-item\">\n                    <b>Views</b><span class=\"js-data\">${views}</span>\n                </p>\n                <p class=\"info-item\">\n                    <b>Comments</b><span class=\"js-data\">${comments}</span>\n                </p>\n                <p class=\"info-item\">\n                    <b>Downloads</b><span class=\"js-data\">${downloads}</span>\n                </p>\n            </div>\n        </div>`\n    })\n    return markup.join('')\n}\n\n\nsearchForm.addEventListener('submit', submitHandler)\n\n\nasync function submitHandler(event) {\n    event.preventDefault()\n    \n    const queryParams = {\n        querry: elements.searchField.value.trim().toLowerCase(),\n        safesearch: elements.safeSearchField.checked,\n        perPege: PERPAGE,\n        page,\n    }\n\n    if (queryParams.querry === '') {\n        message.info('The search field must not be empty');\n        return\n    } else if (queryParams.querry === currentQuerry) {\n        message.info('Looks like you were just looking for this.')\n        return\n    }\n    \n    page = 1;\n    currentQuerry = queryParams.querry\n\n    console.log(queryParams);\n    try {\n        await getImages(queryParams)\n        .then(data => {\n            if (data.total === 0) {\n                elements.galerry.innerHTML = '';\n                message.info('Sorry, there are no images matching your search query. Please try again.');\n                return\n            }\n\n            message.success(`Hooray! We found ${data.totalHits} images.`)\n            elements.galerry.innerHTML = createGalerry(data.hits)\n\n            gallery = new SimpleLightbox('.gallery a', {\n                captionsData: 'alt',\n                captionDelay: 250,\n            });\n            gallery.refresh()\n        })\n        elements.searchField.value = ''\n    } catch (error) {\n        message.error(error)\n    }\n}\n\ndocument.addEventListener(\n    \"scroll\",\n    _.throttle(handlerInfinityScrol, 500)\n);\n\nasync function handlerInfinityScrol() {\n    const windowHeight = window.innerHeight;\n    const documentHeight = document.documentElement.scrollHeight;\n    const scrollPosition = window.scrollY;\n\n    if (documentHeight - (windowHeight + scrollPosition) <= 90) {\n        isLoading = true;\n        page += 1;\n\n        const queryParams = {\n            querry: currentQuerry,\n            safesearch: elements.safeSearchField.checked,\n            perPege: PERPAGE,\n            page,\n        }\n\n        console.log(queryParams);\n        try {\n            await getImages(queryParams)\n                .then(data => {\n                    elements.galerry.innerHTML += createGalerry(data.hits)\n                    gallery.refresh();\n                    const totalPages = Math.ceil(data.totalHits / PERPAGE);\n\n                    if (page >= totalPages) {\n                        document.removeEventListener(\n                            \"scroll\",\n                            _.throttle(handlerInfinityScrol, 500)\n                        );\n                        message.info('Sorry, you have viewed all available images.')\n                    }\n                })\n        } catch (error) {\n            message.error('somthing is wrong')\n        } finally {\n            isLoading = false;\n        }\n    }\n}"],"names":["message","Notiflix","KEY","PERPAGE","getImages","querry","safesearch","page","perPage","axios","gallery","currentQuerry","searchForm","elements","createGalerry","galerryItems","webformatURL","largeImageURL","tags","likes","views","comments","downloads","submitHandler","event","queryParams","data","SimpleLightbox","error","_","handlerInfinityScrol","windowHeight","documentHeight","scrollPosition","totalPages"],"mappings":"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"}